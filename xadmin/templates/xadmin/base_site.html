{% extends 'xadmin/base.html' %}
{% load i18n xadmin_tags %}
{% block title %}{{ title }} | {{ site_title }}{% endblock %}

{% block extrahead %}
  {{ block.super }}
  <script type="text/nunjucks" id="nunjucks-modal-main">
  {% include 'xadmin/modal/main.html' %}
  </script>
{% endblock %}

{% block body %}
  <!-- Header -->
  {% block top-nav %}
    <nav id="top-nav" class="navbar sticky-top navbar-expand-md navbar-dark bg-dark">
      <button class="navbar-toggler" data-toggle="collapse" data-target="#top-nav .navbar-collapse">
        <span class="navbar-toggler-icon"></span>
      </button>
      <a class="navbar-brand mr-auto ml-2 d-none d-sm-block" href="{% url 'xadmin:index' %}">
        {% block branding %}{{ site_title }}{% endblock %}</a>
      <div class="navbar-collapse collapse">
        <ul class="navbar-nav ml-auto">
          {% view_block 'top_navmenu' %}
          {% if user.is_active and user.is_staff %}
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" role="button" data-toggle="dropdown" href="#">
                <strong>{% trans 'Welcome,' %} {% firstof user.first_name user.username %}</strong>
              </a>
              <div id="g-account-menu" class="dropdown-menu" aria-labelledby="navbarDropdown">
                {% view_block 'top_account_menu' %}
              </div>
            </li>
          {% endif %}
          <li class="nav-item">
            <a class="nav-link text-nowrap" href="{% url 'xadmin:logout' %}">
              <i class="fa fa-sign-out-alt" title="{% trans 'Log out' %}"></i>
              <span class="d-md-none d-lg-inline-block">{% trans 'Log out' %}</span>
            </a>
          </li>
        </ul>
        {% view_block 'top_navbar' %}
      </div>
    </nav>
  {% endblock %}
  <div class="container-fluid">
    <div id="body-content" class="{% block body_content_class %}row pt-3{% endblock %}">
      <div id="left-side" class="{% block left_side_class %}col col-md-2 col-lg-4 col-xl-3{% endblock %}">
        {% block navbar %}
          {% if nav_menu %}
            {% include menu_template %}
          {% else %}
            <p>{% trans "You don't have permission to edit anything." %}</p>
          {% endif %}
        {% endblock %}
        {% view_block 'left_navbar' %}
      </div>
      <div id="content-block" class="{% block content_block_class %}col col-md-10 col-lg-8 col-xl-9{% endblock %}">
        {% block breadcrumbs %}
          <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
              {% for bc in breadcrumbs %}
                <li class="breadcrumb-item{% if forloop.last %} active" aria-current="page{% endif %}">
                  {% if forloop.last or not bc.url %}{{ bc.title }}
                  {% else %}<a href="{{ bc.url }}">{{ bc.title }}</a>
                  {% endif %}
                </li>
              {% empty %}
                <li class="breadcrumb-item"><a href="{% url 'xadmin:index' %}">{% trans 'Home' %}</a></li>
                {% if title %}
                  <li class="breadcrumb-item active" aria-current="page">{{ title }}</li>
                {% endif %}
              {% endfor %}
            </ol>
          </nav>
        {% endblock %}

        {% block content-nav %}
          <div class="mb-3">
            <nav class="navbar content-navbar navbar-expand-md navbar-light bg-light border rounded d-none"
                 data-class-xs="navbar fixed-top content-navbar navbar-expand-md navbar-dark bg-dark pb-3"
                 data-class-sm="navbar content-navbar navbar-expand-sm navbar-light bg-light border rounded"
                 data-class-md="navbar content-navbar navbar-expand-md navbar-light bg-light border rounded"
                 data-toggle="breakpoint">
              {% block nav_toggles %}
                {% include "xadmin/includes/toggle_back.html" %}
              {% endblock %}

              {% block nav_brand %}
                <a class="navbar-brand text-truncate mr-auto ml-2 w-25 mnw-250" href="#" data-toggle="collapse"
                   data-target="#top-nav .navbar-collapse">
                  {% block nav_title %}{% endblock %}
                </a>
              {% endblock %}

              <div class="d-flex flex-row flex-nowrap align-items-baseline align-content-end justify-content-end pt-2">
              {% block nav_btns_toggles %}{% endblock %}
              {% view_block 'nav_toggles' %}
              </div>

              <div class="navbar-collapse collapse">
                <ul class="navbar-nav mr-auto">
                  {% view_block 'nav_menu' %}
                </ul>
                {% view_block 'nav_form' %}
                {% block nav_form %}{% endblock %}

                <div class="navbar-btn ml-2"
                     data-class-xs="navbar-btn ml-2 d-none"
                     data-class-md="navbar-btn ml-2 d-md-block"
                     data-toggle=breakpoint>
                  {% view_block 'nav_btns' %}
                  {% block nav_btns %}{% endblock %}
                </div>
              </div>
            </nav>
          </div>
        {% endblock %}

        {% block messages %}
          {% if messages %}
            {% for message in messages %}
              <div class="alert alert-dismissable{% if message.tags %} {% if message.tags == 'error' %}alert-danger{% else %}alert-{{ message.tags }}{% endif %}{% endif %}">
                <button type="button" class="close" data-dismiss="alert" aria-label="{% trans 'Close' %}">&times;</button>
                {{ message|safe }}
              </div>
            {% endfor %}
          {% endif %}
        {% endblock messages %}

        {% block content %}
          {{ content }}
        {% endblock %}
      </div>
    </div>
  </div>

  {% block footer %}
    <div id="footer">
      <hr/>
      <footer class="text-center">
        <p>&copy; {% block site_footer %}{{ site_footer }}{% endblock %}</p>
      </footer>
    </div>
  {% endblock %}

{% endblock body %}
